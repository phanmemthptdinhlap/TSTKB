<!DOCTYPE html><html><head>
      <title>FT-Tranformer</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:////home/lamkien/.vscode/extensions/shd101wyy.markdown-preview-enhanced-0.8.18/crossnote/dependencies/katex/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h3 id="key-points">Key Points </h3>
<ul>
<li>Nghiên cứu cho thấy FT-Transformer là một mô hình mạnh mẽ cho dữ liệu bảng, xử lý cả đặc trưng số và danh mục.</li>
<li>Mô hình sử dụng nhúng tuyến tính cho đặc trưng số và bảng nhúng cho đặc trưng danh mục, sau đó áp dụng Transformer để học mối quan hệ.</li>
<li>Có thể cần điều chỉnh siêu tham số để tối ưu hiệu suất, và hiệu quả phụ thuộc vào tập dữ liệu.</li>
</ul>
<h3 id="kiến-trúc-ft-transformer">Kiến trúc FT-Transformer </h3>
<p>FT-Transformer là một phiên bản của kiến trúc Transformer được thiết kế để xử lý dữ liệu bảng, bao gồm cả đặc trưng số (như tuổi, thu nhập) và đặc trưng danh mục (như giới tính, nghề nghiệp). Mô hình hoạt động như sau:</p>
<ul>
<li><strong>Bộ mã hóa đặc trưng:</strong> Mỗi đặc trưng số được chiếu thành vector nhúng bằng tầng tuyến tính riêng, trong khi đặc trưng danh mục được nhúng bằng bảng nhúng.</li>
<li><strong>Kết hợp và thêm mã [CLS]:</strong> Các vector nhúng được kết hợp, thêm mã [CLS] để tổng hợp thông tin.</li>
<li><strong>Lớp Transformer:</strong> Chuỗi nhúng đi qua nhiều lớp Transformer để học mối quan hệ giữa các đặc trưng.</li>
<li><strong>Dự đoán:</strong> Vector [CLS] cuối cùng được dùng để dự đoán kết quả.</li>
</ul>
<h3 id="ví-dụ-sử-dụng">Ví dụ sử dụng </h3>
<p>Dưới đây là một ví dụ đơn giản để minh họa cách triển khai FT-Transformer bằng Python, với tên biến bằng tiếng Việt để dễ hiểu:</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token keyword keyword-import">import</span> torch
<span class="token keyword keyword-import">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword keyword-as">as</span> nn

<span class="token keyword keyword-class">class</span> <span class="token class-name">FTTransformer</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-def">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> số_đặc_trưng_số<span class="token punctuation">,</span> danh_mục<span class="token punctuation">,</span> kích_thước_nhúng<span class="token punctuation">,</span> độ_sâu<span class="token punctuation">,</span> số_đầu<span class="token punctuation">,</span> kích_thước_mlp<span class="token punctuation">,</span> số_lớp<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>FTTransformer<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>chiếu_số <span class="token operator">=</span> nn<span class="token punctuation">.</span>ModuleList<span class="token punctuation">(</span><span class="token punctuation">[</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> kích_thước_nhúng<span class="token punctuation">)</span> <span class="token keyword keyword-for">for</span> _ <span class="token keyword keyword-in">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>số_đặc_trưng_số<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>nhúng_danh_mục <span class="token operator">=</span> nn<span class="token punctuation">.</span>ModuleList<span class="token punctuation">(</span><span class="token punctuation">[</span>nn<span class="token punctuation">.</span>Embedding<span class="token punctuation">(</span>số_danh_mục<span class="token punctuation">,</span> kích_thước_nhúng<span class="token punctuation">)</span> <span class="token keyword keyword-for">for</span> số_danh_mục <span class="token keyword keyword-in">in</span> danh_mục<span class="token punctuation">]</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>mã_cls <span class="token operator">=</span> nn<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> kích_thước_nhúng<span class="token punctuation">)</span><span class="token punctuation">)</span>
        tổng_mã <span class="token operator">=</span> số_đặc_trưng_số <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>danh_mục<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        self<span class="token punctuation">.</span>nhúng_vị_trí <span class="token operator">=</span> nn<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> tổng_mã<span class="token punctuation">,</span> kích_thước_nhúng<span class="token punctuation">)</span><span class="token punctuation">)</span>
        lớp_bộ_biến_đổi <span class="token operator">=</span> nn<span class="token punctuation">.</span>TransformerEncoderLayer<span class="token punctuation">(</span>d_model<span class="token operator">=</span>kích_thước_nhúng<span class="token punctuation">,</span> nhead<span class="token operator">=</span>số_đầu<span class="token punctuation">,</span> dim_feedforward<span class="token operator">=</span>kích_thước_mlp<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>bộ_biến_đổi <span class="token operator">=</span> nn<span class="token punctuation">.</span>TransformerEncoder<span class="token punctuation">(</span>lớp_bộ_biến_đổi<span class="token punctuation">,</span> num_layers<span class="token operator">=</span>độ_sâu<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>đầu_mlp <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>
            nn<span class="token punctuation">.</span>LayerNorm<span class="token punctuation">(</span>kích_thước_nhúng<span class="token punctuation">)</span><span class="token punctuation">,</span>
            nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>kích_thước_nhúng<span class="token punctuation">,</span> số_lớp<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    
    <span class="token keyword keyword-def">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x_số<span class="token punctuation">,</span> x_danh_mục<span class="token punctuation">)</span><span class="token punctuation">:</span>
        kích_thước_lô <span class="token operator">=</span> x_số<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        nhúng_số <span class="token operator">=</span> <span class="token punctuation">[</span>chiếu<span class="token punctuation">(</span>x_số<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword keyword-for">for</span> i<span class="token punctuation">,</span> chiếu <span class="token keyword keyword-in">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>chiếu_số<span class="token punctuation">)</span><span class="token punctuation">]</span>
        nhúng_số <span class="token operator">=</span> torch<span class="token punctuation">.</span>stack<span class="token punctuation">(</span>nhúng_số<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        nhúng_danh_mục <span class="token operator">=</span> <span class="token punctuation">[</span>nhúng<span class="token punctuation">(</span>x_danh_mục<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword keyword-for">for</span> i<span class="token punctuation">,</span> nhúng <span class="token keyword keyword-in">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>nhúng_danh_mục<span class="token punctuation">)</span><span class="token punctuation">]</span>
        nhúng_danh_mục <span class="token operator">=</span> torch<span class="token punctuation">.</span>stack<span class="token punctuation">(</span>nhúng_danh_mục<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        mã_cls <span class="token operator">=</span> self<span class="token punctuation">.</span>mã_cls<span class="token punctuation">.</span>expand<span class="token punctuation">(</span>kích_thước_lô<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span>mã_cls<span class="token punctuation">,</span> nhúng_số<span class="token punctuation">,</span> nhúng_danh_mục<span class="token punctuation">]</span><span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> x <span class="token operator">+</span> self<span class="token punctuation">.</span>nhúng_vị_trí
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>bộ_biến_đổi<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        đầu_ra_cls <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
        đầu_ra <span class="token operator">=</span> self<span class="token punctuation">.</span>đầu_mlp<span class="token punctuation">(</span>đầu_ra_cls<span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span> đầu_ra

<span class="token comment"># Ví dụ sử dụng</span>
số_đặc_trưng_số <span class="token operator">=</span> <span class="token number">2</span>
danh_mục <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
kích_thước_nhúng <span class="token operator">=</span> <span class="token number">16</span>
độ_sâu <span class="token operator">=</span> <span class="token number">2</span>
số_đầu <span class="token operator">=</span> <span class="token number">4</span>
kích_thước_mlp <span class="token operator">=</span> <span class="token number">32</span>
số_lớp <span class="token operator">=</span> <span class="token number">2</span>
model <span class="token operator">=</span> FTTransformer<span class="token punctuation">(</span>số_đặc_trưng_số<span class="token punctuation">,</span> danh_mục<span class="token punctuation">,</span> kích_thước_nhúng<span class="token punctuation">,</span> độ_sâu<span class="token punctuation">,</span> số_đầu<span class="token punctuation">,</span> kích_thước_mlp<span class="token punctuation">,</span> số_lớp<span class="token punctuation">)</span>
batch_size <span class="token operator">=</span> <span class="token number">4</span>
x_số <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>batch_size<span class="token punctuation">,</span> số_đặc_trưng_số<span class="token punctuation">)</span>
x_danh_mục <span class="token operator">=</span> torch<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>batch_size<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
đầu_ra <span class="token operator">=</span> model<span class="token punctuation">(</span>x_số<span class="token punctuation">,</span> x_danh_mục<span class="token punctuation">)</span>
<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>đầu_ra<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre><h3 id="tối-ưu-hóa">Tối ưu hóa </h3>
<p>Nghiên cứu cho thấy cần điều chỉnh siêu tham số như độ sâu, kích thước nhúng, và tỷ lệ dropout để tối ưu hiệu suất, tùy thuộc vào tập dữ liệu cụ thể.</p>
<hr>
<h3 id="báo-cáo-chi-tiết-về-ft-transformer">Báo cáo chi tiết về FT-Transformer </h3>
<h4 id="giới-thiệu">Giới thiệu </h4>
<p>FT-Transformer, được giới thiệu trong bài báo "Revisiting Deep Learning Models for Tabular Data" (NeurIPS 2021), là một phiên bản điều chỉnh của kiến trúc Transformer để xử lý dữ liệu bảng, bao gồm cả đặc trưng số và danh mục. Mô hình này nổi bật nhờ khả năng học các mối quan hệ phức tạp giữa các đặc trưng, thường vượt trội hơn các mô hình như gradient boosting và ResNet trên nhiều tập dữ liệu.</p>
<h4 id="kiến-trúc-chi-tiết">Kiến trúc chi tiết </h4>
<p>Dựa trên tài liệu từ bài báo và các triển khai thực tế, kiến trúc FT-Transformer bao gồm các thành phần chính:</p>
<ul>
<li>
<p><strong>Bộ mã hóa đặc trưng (Feature Tokenizer):</strong></p>
<ul>
<li>Đối với đặc trưng số, mỗi đặc trưng <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">x_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> được chiếu thành vector nhúng <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>j</mi></msub><mo>=</mo><msub><mi>b</mi><mi>j</mi></msub><mo>+</mo><msub><mi>x</mi><mi>j</mi></msub><mo>⋅</mo><msub><mi>W</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">T_j = b_j + x_j \cdot W_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7306em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>, với <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">b_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> là vector bias và <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>j</mi></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">W_j \in \mathbb{R}^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span> là vector trọng số. Điều này cho phép mỗi đặc trưng số được biểu diễn trong không gian nhúng có kích thước <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>.</li>
<li>Đối với đặc trưng danh mục, mỗi giá trị danh mục được ánh xạ qua một bảng nhúng <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>j</mi></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msub><mi>S</mi><mi>j</mi></msub><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding="application/x-tex">W_j \in \mathbb{R}^{S_j \times d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span>, với <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">S_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> là số giá trị có thể của đặc trưng đó.</li>
</ul>
</li>
<li>
<p><strong>Kết hợp và thêm mã [CLS]:</strong></p>
<ul>
<li>Tất cả các vector nhúng được kết hợp thành một chuỗi <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>k</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding="application/x-tex">T \in \mathbb{R}^{k \times d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span>, với <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> là tổng số đặc trưng (số và danh mục).</li>
<li>Một mã [CLS] đặc biệt được thêm vào đầu chuỗi, giúp tổng hợp thông tin cho dự đoán cuối cùng.</li>
</ul>
</li>
<li>
<p><strong>Lớp Transformer:</strong></p>
<ul>
<li>Chuỗi nhúng, bao gồm mã [CLS], được truyền qua <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span> lớp Transformer, mỗi lớp gồm:
<ul>
<li>Multi-Head Self-Attention (MHSA) để học mối quan hệ giữa các đặc trưng.</li>
<li>Feed Forward Network (FFN) để xử lý độc lập từng đặc trưng.</li>
<li>Layer Normalization và kết nối dư (residual connections) để ổn định huấn luyện.</li>
</ul>
</li>
<li>Sử dụng PreNorm để tối ưu hóa, với việc loại bỏ chuẩn hóa lớp đầu tiên trong tầng đầu tiên để cải thiện hiệu suất.</li>
</ul>
</li>
<li>
<p><strong>Dự đoán:</strong></p>
<ul>
<li>Sau khi qua các lớp Transformer, vector nhúng của mã [CLS] được lấy ra và truyền qua một mạng nơ-ron đơn giản: LayerNorm -&gt; ReLU -&gt; Linear, để tạo ra dự đoán cuối cùng.</li>
</ul>
</li>
</ul>
<h4 id="ví-dụ-minh-họa">Ví dụ minh họa </h4>
<p>Dưới đây là một ví dụ mã giả bằng Python với PyTorch, sử dụng tên biến tiếng Việt để dễ hiểu:</p>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token keyword keyword-import">import</span> torch
<span class="token keyword keyword-import">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword keyword-as">as</span> nn

<span class="token keyword keyword-class">class</span> <span class="token class-name">FTTransformer</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword keyword-def">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> số_đặc_trưng_số<span class="token punctuation">,</span> danh_mục<span class="token punctuation">,</span> kích_thước_nhúng<span class="token punctuation">,</span> độ_sâu<span class="token punctuation">,</span> số_đầu<span class="token punctuation">,</span> kích_thước_mlp<span class="token punctuation">,</span> số_lớp<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>FTTransformer<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        self<span class="token punctuation">.</span>chiếu_số <span class="token operator">=</span> nn<span class="token punctuation">.</span>ModuleList<span class="token punctuation">(</span><span class="token punctuation">[</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> kích_thước_nhúng<span class="token punctuation">)</span> <span class="token keyword keyword-for">for</span> _ <span class="token keyword keyword-in">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>số_đặc_trưng_số<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>nhúng_danh_mục <span class="token operator">=</span> nn<span class="token punctuation">.</span>ModuleList<span class="token punctuation">(</span><span class="token punctuation">[</span>nn<span class="token punctuation">.</span>Embedding<span class="token punctuation">(</span>số_danh_mục<span class="token punctuation">,</span> kích_thước_nhúng<span class="token punctuation">)</span> <span class="token keyword keyword-for">for</span> số_danh_mục <span class="token keyword keyword-in">in</span> danh_mục<span class="token punctuation">]</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>mã_cls <span class="token operator">=</span> nn<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> kích_thước_nhúng<span class="token punctuation">)</span><span class="token punctuation">)</span>
        tổng_mã <span class="token operator">=</span> số_đặc_trưng_số <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>danh_mục<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        self<span class="token punctuation">.</span>nhúng_vị_trí <span class="token operator">=</span> nn<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> tổng_mã<span class="token punctuation">,</span> kích_thước_nhúng<span class="token punctuation">)</span><span class="token punctuation">)</span>
        lớp_bộ_biến_đổi <span class="token operator">=</span> nn<span class="token punctuation">.</span>TransformerEncoderLayer<span class="token punctuation">(</span>d_model<span class="token operator">=</span>kích_thước_nhúng<span class="token punctuation">,</span> nhead<span class="token operator">=</span>số_đầu<span class="token punctuation">,</span> dim_feedforward<span class="token operator">=</span>kích_thước_mlp<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>bộ_biến_đổi <span class="token operator">=</span> nn<span class="token punctuation">.</span>TransformerEncoder<span class="token punctuation">(</span>lớp_bộ_biến_đổi<span class="token punctuation">,</span> num_layers<span class="token operator">=</span>độ_sâu<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>đầu_mlp <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>
            nn<span class="token punctuation">.</span>LayerNorm<span class="token punctuation">(</span>kích_thước_nhúng<span class="token punctuation">)</span><span class="token punctuation">,</span>
            nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>kích_thước_nhúng<span class="token punctuation">,</span> số_lớp<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    
    <span class="token keyword keyword-def">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x_số<span class="token punctuation">,</span> x_danh_mục<span class="token punctuation">)</span><span class="token punctuation">:</span>
        kích_thước_lô <span class="token operator">=</span> x_số<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        nhúng_số <span class="token operator">=</span> <span class="token punctuation">[</span>chiếu<span class="token punctuation">(</span>x_số<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword keyword-for">for</span> i<span class="token punctuation">,</span> chiếu <span class="token keyword keyword-in">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>chiếu_số<span class="token punctuation">)</span><span class="token punctuation">]</span>
        nhúng_số <span class="token operator">=</span> torch<span class="token punctuation">.</span>stack<span class="token punctuation">(</span>nhúng_số<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        nhúng_danh_mục <span class="token operator">=</span> <span class="token punctuation">[</span>nhúng<span class="token punctuation">(</span>x_danh_mục<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword keyword-for">for</span> i<span class="token punctuation">,</span> nhúng <span class="token keyword keyword-in">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>nhúng_danh_mục<span class="token punctuation">)</span><span class="token punctuation">]</span>
        nhúng_danh_mục <span class="token operator">=</span> torch<span class="token punctuation">.</span>stack<span class="token punctuation">(</span>nhúng_danh_mục<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        mã_cls <span class="token operator">=</span> self<span class="token punctuation">.</span>mã_cls<span class="token punctuation">.</span>expand<span class="token punctuation">(</span>kích_thước_lô<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span>mã_cls<span class="token punctuation">,</span> nhúng_số<span class="token punctuation">,</span> nhúng_danh_mục<span class="token punctuation">]</span><span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> x <span class="token operator">+</span> self<span class="token punctuation">.</span>nhúng_vị_trí
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>bộ_biến_đổi<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        đầu_ra_cls <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
        đầu_ra <span class="token operator">=</span> self<span class="token punctuation">.</span>đầu_mlp<span class="token punctuation">(</span>đầu_ra_cls<span class="token punctuation">)</span>
        <span class="token keyword keyword-return">return</span> đầu_ra

<span class="token comment"># Ví dụ sử dụng</span>
số_đặc_trưng_số <span class="token operator">=</span> <span class="token number">2</span>
danh_mục <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
kích_thước_nhúng <span class="token operator">=</span> <span class="token number">16</span>
độ_sâu <span class="token operator">=</span> <span class="token number">2</span>
số_đầu <span class="token operator">=</span> <span class="token number">4</span>
kích_thước_mlp <span class="token operator">=</span> <span class="token number">32</span>
số_lớp <span class="token operator">=</span> <span class="token number">2</span>
model <span class="token operator">=</span> FTTransformer<span class="token punctuation">(</span>số_đặc_trưng_số<span class="token punctuation">,</span> danh_mục<span class="token punctuation">,</span> kích_thước_nhúng<span class="token punctuation">,</span> độ_sâu<span class="token punctuation">,</span> số_đầu<span class="token punctuation">,</span> kích_thước_mlp<span class="token punctuation">,</span> số_lớp<span class="token punctuation">)</span>
batch_size <span class="token operator">=</span> <span class="token number">4</span>
x_số <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>batch_size<span class="token punctuation">,</span> số_đặc_trưng_số<span class="token punctuation">)</span>
x_danh_mục <span class="token operator">=</span> torch<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>batch_size<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
đầu_ra <span class="token operator">=</span> model<span class="token punctuation">(</span>x_số<span class="token punctuation">,</span> x_danh_mục<span class="token punctuation">)</span>
<span class="token keyword keyword-print">print</span><span class="token punctuation">(</span>đầu_ra<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre><h4 id="tối-ưu-hóa-và-hiệu-suất">Tối ưu hóa và hiệu suất </h4>
<p>Nghiên cứu cho thấy FT-Transformer có hiệu suất tốt trên nhiều tập dữ liệu, với xếp hạng trung bình 1.8 so với các mô hình khác (theo bảng 2 trong bài báo). Tuy nhiên, mô hình yêu cầu nhiều tài nguyên hơn so với các mô hình đơn giản như ResNet, với thời gian huấn luyện lâu hơn (ví dụ: 13.8 lần trên tập dữ liệu Yahoo, bảng 10). Độ phức tạp bậc hai của MHSA có thể được giảm bằng cách sử dụng các phương pháp xấp xỉ hiệu quả.</p>
<h4 id="so-sánh-với-các-mô-hình-khác">So sánh với các mô hình khác </h4>
<p>Dưới đây là bảng so sánh FT-Transformer với các mô hình khác dựa trên tài liệu:</p>
<table>
<thead>
<tr>
<th>Mô hình</th>
<th>Ưu điểm</th>
<th>Nhược điểm</th>
</tr>
</thead>
<tbody>
<tr>
<td>FT-Transformer</td>
<td>Xử lý tốt cả số và danh mục, hiệu suất cao</td>
<td>Yêu cầu tài nguyên lớn, huấn luyện lâu</td>
</tr>
<tr>
<td>Gradient Boosting</td>
<td>Nhanh, hiệu quả trên nhiều tập dữ liệu</td>
<td>Không học được mối quan hệ phức tạp</td>
</tr>
<tr>
<td>ResNet</td>
<td>Đơn giản, ít tài nguyên</td>
<td>Hiệu suất thấp hơn trên nhiều nhiệm vụ</td>
</tr>
</tbody>
</table>
<h4 id="tài-nguyên-và-triển-khai">Tài nguyên và triển khai </h4>
<ul>
<li>Gói Python để triển khai: <code>tabtransformertf</code>, cài đặt bằng <code>pip install tabtransformertf</code>.</li>
<li>Mã nguồn: Có sẵn tại <a href="https://github.com/yandex-research/tabular-dl-revisiting-models">GitHub</a>.</li>
<li>Ví dụ thực tế: Đánh giá trên tập dữ liệu Adult Income Dataset (<a href="https://archive.ics.uci.edu/ml/datasets/adult">tập dữ liệu</a>), đạt độ chính xác 0.8576, gần với báo cáo 0.86.</li>
</ul>
<h4 id="kết-luận">Kết luận </h4>
<p>FT-Transformer là một công cụ mạnh mẽ cho dữ liệu bảng, với khả năng xử lý cả đặc trưng số và danh mục. Tuy nhiên, cần tối ưu hóa siêu tham số và cân nhắc tài nguyên khi triển khai. Ví dụ mã trên minh họa cách triển khai cơ bản, và người dùng có thể điều chỉnh theo nhu cầu cụ thể.</p>
<h3 id="key-citations">Key Citations </h3>
<ul>
<li><a href="https://arxiv.org/pdf/2106.11959">Revisiting Deep Learning Models for Tabular Data</a></li>
<li><a href="https://archive.ics.uci.edu/ml/datasets/adult">Adult Income Dataset for Machine Learning</a></li>
<li><a href="https://github.com/yandex-research/tabular-dl-revisiting-models">GitHub Repository for FT-Transformer</a></li>
</ul>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>